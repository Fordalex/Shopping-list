{% extends 'base.html' %}
{% block content %}

<!-- setttings -->
<div class="row m-0 p-0">
    <div class="col-12 m-0 p-0">
        <img src="https://img.icons8.com/fluent/25/000000/settings.png" class="float-right" data-toggle="collapse" href="#settings"/>
    </div>
</div>

<div class="row collapse" id="settings">
    <div class="col d-flex justify-content-center">
        <a href="{% url 'account_email' %}" class="btn btn-warning">Change E-mail</a>
    </div>
    <div class="col d-flex justify-content-center">
        <a href="{% url 'account_logout' %}" class="btn btn-danger">Sign Out</a>
    </div>
</div>

<!-- header -->
<div class="row justify-content-center">
    <div class="col-12 col-md-6">
        <h1 class="text-center">Welcome {{ user.username }}</h1>
        <p class="m-0 text-center">Your registered email is: {{ user.email }}</p>
    </div>
</div>
<div class="row">
    <div class="col-12 d-flex justify-content-between mt-1">
        <a href="/items/items/">
            <img src="https://img.icons8.com/fluent/32/000000/add.png" data-toggle="collapse" href="#add_form" />
        </a>
        <img src="https://img.icons8.com/color/32/000000/delete-forever.png" data-toggle="collapse" href=".delete" />
    </div>
</div>
<hr>

<!-- Show all items in their categories -->
{% for cat in categories %} 
    {% if cat %}
        <h5 class="mt-3">{{ cat }}</h5>
        <ol class="mt-4 pl-2 list" id="list_{{forloop.counter}}">
            {% for item in items %}
                {% if item.category == cat %}
                    <li class="d-flex justify-content-start mt-1"><span>. {{ item.name }}</span><a href="/items/delete/{{item.id}}" class="btn btn-danger btn-sm float-right collapse delete">Delete</a></li>
                {% endif %}
            {% endfor %}
        </ol>
        <hr>
    {% endif %}
{% endfor %}
<div class="row">
    <div class="col-12">
        <a href="/items/delete_all/" class="container-fluid collapse delete btn btn-danger">Delete All!</a>
    </div>
</div>

<!-- show all users. Remove and friend users. -->
<div class="row">
    <div class="col-12">
        <h3 class="text-center my-4">Users</h3>
    </div>
    <div class="col-6">
        <h4>All Users</h4>
        {% for user in users %}
            {% if user.username != request.user.username %}
                <div class="d-flex justify-content-between align-items-center">
                    <p>{{ user.username }}</p>
                    <a href="/items/connect/add/{{user.id}}">
                        <img src="https://img.icons8.com/fluent/25/000000/add-user-male.png"/>
                    </a>
                </div>
            {% endif %}
        {% endfor %}
    </div>
    <div class="col-6">
        <h4>Shopping partners</h4>
        {% for friend in friends %}
        <div class="d-flex justify-content-between align-items-center">
            <p>{{ friend.username }}</p>
            <a href="/items/connect/remove/{{friend.id}}">
                <img src="https://img.icons8.com/color/25/000000/remove-user-male--v1.png"/>
            </a>
            </div>
        {% endfor %}
    </div>
</div>

<script>
    // Number the items in each list
    var list_count = $('.list').length

    for(let i = 0; i < list_count; i++) {
        var target_list = '#list_'.concat(i + 1)
        var amount_of_items = $(target_list).children().length
        for(let l = 0; l < amount_of_items; l++) {
            $(target_list).children()[l].prepend(l + 1)
        }
    }

</script>

{% endblock %}